import createPlan from './assets/create-plan.webm';
import firstSimulation from './assets/first-simulation.webm';

# Create Plan and Simulate

Here we describe how to create a new plan and simulate it using the [Aerie UI](https://github.com/NASA-AMMOS/aerie-ui).
This document assumes you already uploaded a model. If you still need to upload a model, first follow the [instructions for uploading a model](../upload-mission-model) and then come back here.

## Instructions

1. Navigate to the `/plans` page in the Aerie UI. If you are running Aerie locally it is at [http://localhost/plans](http://localhost/plans).

1. Fill out the form on the `/plans` page to create a new plan. Pick a model ("FireSat" in this example), and give the plan a name ("Demo Plan" in this example). For this example we will just create a 2-week plan, and we will not include a [simulation template](../../mission-modeling/configuration). After you fill in all the fields click the 'Create' button to create the plan. Here is a video demonstration:

   <video controls>
     <source src={createPlan} type="video/webm" />
   </video>

1. Next open the new plan and add a few activities to it by dragging the activity types in the left pane over to the timeline. Select the simulation tab and click the "play" button to simulate the plan. The default timeline view for Aerie UI automatically includes all the resources in the plan-associated-model so you can see the simulation output easily. Here is a video demonstration:

   <video controls>
     <source src={firstSimulation} type="video/webm" />
   </video>

   Notice in this demonstration we change the activity parameter of `ChangeMagMode` from "LOW_RATE" to "HIGH_RATE" which effects some resources as shown in the timeline simulation output.

## Advanced: Temporal Subset Simulation

:::caution

Temporal Subset Simulation sets the value of all internal states to their initial values based on the Simulation Configuration.

This means that running Temporal Subset Simulation on a region of a plan detached from Plan Start may produce **different** output then if you were to simulate from Plan Start.

:::

It is possible to simulate only a section of the plan. This can be done by setting the `Simulation Start` and `Simulation End` fields in the Simulation Configuration Panel.

The bounds can be set to any point in the plan in one of three ways:

1. Click the bound and select from the Date Picker
2. Right-click on the timeline and select `Set as Plan Start` or `Set as Plan End`
3. Right-click on an Activity Directive or Simulated Activity and use the `Set Simulation Start` and `Set Simulation End` options.

To go back to simulating the entire plan, edit `Simulation Start` and `Simulation End` and select `Plan Start` and `Plan End`, respectively.
